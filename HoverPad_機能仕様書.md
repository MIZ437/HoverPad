# HoverPad

**Virtual Control Panel**

## 機能仕様書

| 項目 | 内容 |
|------|------|
| ドキュメント名 | HoverPad 機能仕様書 |
| バージョン | 1.0 |
| 作成日 | 2025年12月13日 |
| 用途 | 個人学習・プログラミング学習用 |

---

## 1. 製品概要

### 1.1 コンセプト

HoverPadは、デスクトップ画面上に表示される仮想ボタンパネル（オーバーレイ）です。ユーザーが定義したアクションをワンクリックで実行でき、作業効率を向上させるワークスペースコントローラーとして機能します。

### 1.2 主要機能

- 画面上に常駐するカスタマイズ可能なボタンパネル
- 各ボタンに任意のアクション（コマンド実行、キー入力、アプリ起動等）を割り当て
- 固定表示 / ホットキー呼び出しの切替
- 複数パネルの同時運用
- プロファイル機能によるコンテキスト切替

---

## 2. システム構成

### 2.1 アーキテクチャ概要

| レイヤー | 役割・技術要素 |
|----------|----------------|
| UIレイヤー | オーバーレイウィンドウ、ボタングリッド描画、ドラッグ移動 |
| ロジックレイヤー | アクション実行エンジン、ホットキー監視、プロファイル管理 |
| データレイヤー | 設定ファイル（JSON/YAML）、アイコンリソース、プロファイルデータ |
| プラグインレイヤー | 拡張機能インターフェース、外部アプリ連携API |

### 2.2 技術スタック候補

| カテゴリ | 候補技術 |
|----------|----------|
| GUI Framework | Electron, Tauri, Qt, WPF, PyQt/PySide |
| 言語 | TypeScript, Rust, C++, Python, C# |
| 設定管理 | JSON, YAML, SQLite |
| ホットキー | OS Native API, グローバルキーフック |
| オーバーレイ | 透過ウィンドウ、Always-on-Top、クリックスルー制御 |

---

## 3. 機能仕様

### 3.1 パネル表示機能

#### 3.1.1 グリッドレイアウト

| 仕様項目 | 値・説明 |
|----------|----------|
| 最大グリッドサイズ | 8行 × 8列（64ボタン/パネル） |
| 最小グリッドサイズ | 1行 × 1列 |
| 行・列設定 | ユーザーが任意に設定可能 |
| ボタンサイズ | 可変（ピクセル単位で調整可能） |
| ボタン間隔 | 0〜20px（設定可能） |
| 空ボタン表示 | 表示/非表示の切替オプション |

#### 3.1.2 表示モード

**【固定モード（Docked）】**

1. 画面上の任意座標にパネルを配置
2. ドラッグによる位置移動
3. 画面端へのスナップ機能（マグネット吸着）
4. 常時最前面表示（Always-on-Top）

**【動的モード（Hover/Popup）】**

1. グローバルホットキーでマウスカーソル位置に表示
2. フォーカス喪失時の自動非表示
3. アクション実行後の自動非表示オプション
4. 表示アニメーション（フェードイン/スライドイン）

#### 3.1.3 外観カスタマイズ

| 設定項目 | 詳細 |
|----------|------|
| パネル透明度 | 0%〜100%（スライダー調整） |
| パネル背景色 | カラーピッカーで任意色を選択 |
| ボタン背景色 | デフォルト色 + 個別設定 |
| ボタン枠線 | 色・太さ・角丸半径の設定 |
| フォント | システムフォントから選択、サイズ・色設定 |
| アイコン | 画像ファイル（PNG/SVG）、または絵文字 |

---

### 3.2 ボタン・アクション機能

#### 3.2.1 アクションタイプ

| アクション種別 | 動作内容 |
|----------------|----------|
| ホットキー送信 | 任意のキーボードショートカットをシステムに送信 |
| テキスト入力 | 定型文をクリップボード経由または直接入力 |
| アプリ起動 | 指定した実行ファイル/URLを開く |
| コマンド実行 | シェルコマンド/スクリプトを実行 |
| フォルダを開く | 指定ディレクトリをファイラーで開く |
| マルチアクション | 複数アクションを順次/遅延実行 |
| トグルアクション | ON/OFF状態を持つ2状態切替 |
| フォルダ（階層） | サブパネルを開く（入れ子構造） |
| プロファイル切替 | 別のプロファイルに切り替え |
| システム制御 | 音量調整、メディア再生制御、画面輝度等 |

#### 3.2.2 マルチアクション仕様

- 1ボタンに複数アクションを登録可能
- アクション間の遅延時間を設定（ミリ秒単位）
- 実行順序のドラッグ&ドロップ並べ替え
- 条件分岐（IF文）：トグル状態や時刻による分岐

#### 3.2.3 ボタン状態表示

- 通常状態 / ホバー状態 / 押下状態の視覚フィードバック
- トグルボタンのON/OFF状態表示（アイコン・色変化）
- 動的テキスト表示（時計、カウンター、外部データ等）

---

### 3.3 プロファイル機能

| 機能 | 説明 |
|------|------|
| プロファイル作成 | 用途別にボタン配置・アクションを保存 |
| 手動切替 | メニューまたはボタンアクションで切替 |
| 自動切替 | アクティブウィンドウのプロセス名に応じて自動切替 |
| インポート/エクスポート | JSON形式でプロファイルを保存・共有 |
| デフォルトプロファイル | マッチするルールがない場合のフォールバック |

---

### 3.4 グローバルホットキー機能

1. パネル表示/非表示のトグル
2. 各パネルに個別のホットキーを割当可能
3. 修飾キー（Ctrl/Alt/Shift/Win）+ 任意キーの組合せ
4. 他アプリとのホットキー競合検出・警告
5. ホットキー一時無効化オプション

---

### 3.5 マルチパネル機能

- 複数の独立したパネルを同時に作成・表示
- 各パネルに個別のレイアウト・プロファイル・ホットキー
- パネル間でのボタン/アクションのコピー＆ペースト
- パネルのグループ化（一括表示/非表示）

---

## 4. データ構造

### 4.1 設定ファイル構造（JSON）

**config.json**

| キー | 型 | 説明 |
|------|-----|------|
| panels[] | Array | パネル定義の配列 |
| panels[].id | String | パネル一意ID（UUID） |
| panels[].name | String | パネル表示名 |
| panels[].rows | Number | 行数（1-8） |
| panels[].cols | Number | 列数（1-8） |
| panels[].mode | String | "docked" \| "dynamic" |
| panels[].hotkey | String | 表示ホットキー（例: "Ctrl+Shift+D"） |
| panels[].position | Object | { x: number, y: number } |
| panels[].appearance | Object | 外観設定（透明度、色等） |
| panels[].buttons[] | Array | ボタン定義配列 |

### 4.2 ボタン定義構造

| キー | 型 | 説明 |
|------|-----|------|
| id | String | ボタン一意ID |
| position | Object | { row: number, col: number } |
| label | String | 表示テキスト |
| icon | String | アイコンパス or 絵文字 |
| actions[] | Array | 実行アクション配列 |
| style | Object | 個別スタイル設定 |

### 4.3 アクション定義構造

| キー | 型 | 説明 |
|------|-----|------|
| type | String | "hotkey" \| "command" \| "open" \| "text" \| etc. |
| payload | Any | アクション固有のパラメータ |
| delay | Number | 次アクションまでの遅延（ms） |

### 4.4 設定ファイルサンプル

```json
{
  "version": "1.0",
  "panels": [
    {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "name": "メインパネル",
      "rows": 3,
      "cols": 4,
      "mode": "dynamic",
      "hotkey": "Ctrl+Shift+Space",
      "position": { "x": 100, "y": 100 },
      "appearance": {
        "opacity": 0.95,
        "backgroundColor": "#2C3E50",
        "buttonSize": 64,
        "gap": 8,
        "borderRadius": 8
      },
      "buttons": [
        {
          "id": "btn-001",
          "position": { "row": 0, "col": 0 },
          "label": "メモ帳",
          "icon": "📝",
          "actions": [
            {
              "type": "open",
              "payload": { "path": "notepad.exe" },
              "delay": 0
            }
          ],
          "style": {
            "backgroundColor": "#3498DB"
          }
        },
        {
          "id": "btn-002",
          "position": { "row": 0, "col": 1 },
          "label": "コピー",
          "icon": "📋",
          "actions": [
            {
              "type": "hotkey",
              "payload": { "keys": "Ctrl+C" },
              "delay": 0
            }
          ]
        }
      ]
    }
  ],
  "profiles": [
    {
      "id": "profile-default",
      "name": "デフォルト",
      "isDefault": true,
      "autoSwitch": []
    },
    {
      "id": "profile-vscode",
      "name": "VS Code用",
      "isDefault": false,
      "autoSwitch": [
        { "process": "Code.exe" }
      ]
    }
  ],
  "settings": {
    "startWithOS": true,
    "showInTray": true,
    "theme": "dark"
  }
}
```

---

## 5. 画面構成

### 5.1 主要画面一覧

| 画面名 | 機能概要 |
|--------|----------|
| パネルウィンドウ | ボタングリッドを表示するオーバーレイ（メイン機能） |
| 設定画面 | 全体設定・パネル管理・プロファイル管理 |
| ボタン編集画面 | 個別ボタンのアクション・外観設定 |
| アクション編集画面 | マルチアクションの詳細設定 |
| システムトレイメニュー | クイックアクセス（表示切替、終了等） |

### 5.2 画面遷移図

```
┌─────────────────────────────────────────────────────────┐
│                    システムトレイ                        │
│  ┌─────────────────────────────────────────────────┐   │
│  │ • パネル表示/非表示                              │   │
│  │ • 設定を開く ──────────────────┐               │   │
│  │ • 終了                         │               │   │
│  └─────────────────────────────────────────────────┘   │
└───────────────────────────────│─────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────┐
│                      設定画面                           │
│  ┌──────────┬──────────┬──────────┬──────────┐        │
│  │ パネル   │プロファイル│ ホットキー │ 一般設定  │        │
│  └────┬─────┴──────────┴──────────┴──────────┘        │
│       │                                                │
│       ▼                                                │
│  ┌─────────────────────────────────────────────┐      │
│  │ パネル一覧                                   │      │
│  │  [+] 新規作成                                │      │
│  │  • メインパネル ─────┐                      │      │
│  │  • サブパネル        │                      │      │
│  └──────────────────────│──────────────────────┘      │
└─────────────────────────│───────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────────┐
│                  パネル編集画面                          │
│  ┌─────────────────────────────────────────────┐      │
│  │  [btn] [btn] [btn] [btn]                    │      │
│  │  [btn] [btn] [btn] [btn]  ← クリックで編集   │      │
│  │  [btn] [btn] [btn] [btn]        │           │      │
│  └─────────────────────────────────│───────────┘      │
│                                    │                   │
└────────────────────────────────────│───────────────────┘
                                     │
                                     ▼
┌─────────────────────────────────────────────────────────┐
│                  ボタン編集画面                          │
│  ┌─────────────────────────────────────────────┐      │
│  │ ラベル: [____________]                       │      │
│  │ アイコン: [選択...] 🎨                       │      │
│  │ アクション:                                  │      │
│  │   [+] アクション追加 ────┐                  │      │
│  │   1. ホットキー Ctrl+C   │                  │      │
│  │   2. 遅延 100ms          │                  │      │
│  └──────────────────────────│──────────────────┘      │
└─────────────────────────────│───────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────┐
│                アクション編集画面                        │
│  ┌─────────────────────────────────────────────┐      │
│  │ タイプ: [ホットキー ▼]                       │      │
│  │ キー:   [Ctrl+C    ]                        │      │
│  │ 遅延:   [0    ] ms                          │      │
│  │                                              │      │
│  │        [キャンセル] [保存]                   │      │
│  └─────────────────────────────────────────────┘      │
└─────────────────────────────────────────────────────────┘
```

---

## 6. 非機能要件

### 6.1 パフォーマンス

| 指標 | 目標値 |
|------|--------|
| 起動時間 | 3秒以内 |
| ホットキー応答 | 200ms以内にパネル表示 |
| アクション実行 | 50ms以内に処理開始 |
| メモリ使用量 | 100MB以下（アイドル時） |
| CPU使用率 | 1%以下（アイドル時） |

### 6.2 ユーザビリティ

1. ドラッグ&ドロップによる直感的な設定
2. 設定変更の即時反映（リアルタイムプレビュー）
3. Undo/Redo機能（設定編集時）
4. ツールチップによるヘルプ表示

### 6.3 信頼性

1. 設定ファイルの自動バックアップ
2. 異常終了時の設定復元機能
3. 不正な設定値の検証・エラーハンドリング

---

## 7. 拡張性・将来構想

- **プラグインシステム**: 外部モジュールによる機能追加
- **スクリプトアクション**: Lua/Pythonスクリプト実行
- **API公開**: 外部アプリからの操作インターフェース
- **テーマシステム**: 外観の一括変更
- **クラウド同期**: 設定の複数デバイス間共有
- **Web連携**: Webhookトリガー、REST API呼出し

---

## 8. 用語集

| 用語 | 定義 |
|------|------|
| パネル | ボタンを配置するグリッド状のオーバーレイウィンドウ |
| アクション | ボタン押下時に実行される処理 |
| マルチアクション | 複数のアクションを順次実行する機能 |
| プロファイル | パネル設定のスナップショット（用途別に切替） |
| ホットキー | キーボードショートカット（グローバルに機能） |
| オーバーレイ | 他のウィンドウの上に重ねて表示されるUI |
| トグル | ON/OFFの2状態を切り替える動作 |
| スナップ | 画面端などに吸着する配置補助機能 |
| Hover | マウスカーソルを要素上に置いた状態 |

---

*― 以上 ―*
